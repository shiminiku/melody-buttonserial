(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const pe=(e,n)=>e===n,ge=Symbol("solid-track"),M={equals:pe};let we=ie;const C=1,k=2,ee={owned:null,cleanups:null,context:null,owner:null};var g=null;let H=null,p=null,y=null,x=null,j=0;function L(e,n){const t=p,l=g,s=e.length===0,r=n===void 0?l:n,o=s?ee:{owned:null,cleanups:null,context:r?r.context:null,owner:r},i=s?e:()=>e(()=>O(()=>D(o)));g=o,p=null;try{return B(i,!0)}finally{p=t,g=l}}function E(e,n){n=n?Object.assign({},M,n):M;const t={value:e,observers:null,observerSlots:null,comparator:n.equals||void 0},l=s=>(typeof s=="function"&&(s=s(t.value)),se(t,s));return[ne.bind(t),l]}function F(e,n,t){const l=le(e,n,!1,C);U(l)}function G(e,n,t){t=t?Object.assign({},M,t):M;const l=le(e,n,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=t.equals||void 0,U(l),ne.bind(l)}function O(e){if(p===null)return e();const n=p;p=null;try{return e()}finally{p=n}}function te(e){return g===null||(g.cleanups===null?g.cleanups=[e]:g.cleanups.push(e)),e}function ne(){if(this.sources&&this.state)if(this.state===C)U(this);else{const e=y;y=null,B(()=>q(this),!1),y=e}if(p){const e=this.observers?this.observers.length:0;p.sources?(p.sources.push(this),p.sourceSlots.push(e)):(p.sources=[this],p.sourceSlots=[e]),this.observers?(this.observers.push(p),this.observerSlots.push(p.sources.length-1)):(this.observers=[p],this.observerSlots=[p.sources.length-1])}return this.value}function se(e,n,t){let l=e.value;return(!e.comparator||!e.comparator(l,n))&&(e.value=n,e.observers&&e.observers.length&&B(()=>{for(let s=0;s<e.observers.length;s+=1){const r=e.observers[s],o=H&&H.running;o&&H.disposed.has(r),(o?!r.tState:!r.state)&&(r.pure?y.push(r):x.push(r),r.observers&&oe(r)),o||(r.state=C)}if(y.length>1e6)throw y=[],new Error},!1)),n}function U(e){if(!e.fn)return;D(e);const n=j;be(e,e.value,n)}function be(e,n,t){let l;const s=g,r=p;p=g=e;try{l=e.fn(n)}catch(o){return e.pure&&(e.state=C,e.owned&&e.owned.forEach(D),e.owned=null),e.updatedAt=t+1,ue(o)}finally{p=r,g=s}(!e.updatedAt||e.updatedAt<=t)&&(e.updatedAt!=null&&"observers"in e?se(e,l):e.value=l,e.updatedAt=t)}function le(e,n,t,l=C,s){const r={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:n,owner:g,context:g?g.context:null,pure:t};return g===null||g!==ee&&(g.owned?g.owned.push(r):g.owned=[r]),r}function re(e){if(e.state===0)return;if(e.state===k)return q(e);if(e.suspense&&O(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<j);)e.state&&n.push(e);for(let t=n.length-1;t>=0;t--)if(e=n[t],e.state===C)U(e);else if(e.state===k){const l=y;y=null,B(()=>q(e,n[0]),!1),y=l}}function B(e,n){if(y)return e();let t=!1;n||(y=[]),x?t=!0:x=[],j++;try{const l=e();return ye(t),l}catch(l){t||(x=null),y=null,ue(l)}}function ye(e){if(y&&(ie(y),y=null),e)return;const n=x;x=null,n.length&&B(()=>we(n),!1)}function ie(e){for(let n=0;n<e.length;n++)re(e[n])}function q(e,n){e.state=0;for(let t=0;t<e.sources.length;t+=1){const l=e.sources[t];if(l.sources){const s=l.state;s===C?l!==n&&(!l.updatedAt||l.updatedAt<j)&&re(l):s===k&&q(l,n)}}}function oe(e){for(let n=0;n<e.observers.length;n+=1){const t=e.observers[n];t.state||(t.state=k,t.pure?y.push(t):x.push(t),t.observers&&oe(t))}}function D(e){let n;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),l=e.sourceSlots.pop(),s=t.observers;if(s&&s.length){const r=s.pop(),o=t.observerSlots.pop();l<s.length&&(r.sourceSlots[o]=l,s[l]=r,t.observerSlots[l]=o)}}if(e.owned){for(n=e.owned.length-1;n>=0;n--)D(e.owned[n]);e.owned=null}if(e.cleanups){for(n=e.cleanups.length-1;n>=0;n--)e.cleanups[n]();e.cleanups=null}e.state=0}function me(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function ue(e,n=g){throw me(e)}const Se=Symbol("fallback");function Q(e){for(let n=0;n<e.length;n++)e[n]()}function Ae(e,n,t={}){let l=[],s=[],r=[],o=0,i=n.length>1?[]:null;return te(()=>Q(r)),()=>{let a=e()||[],d,u;return a[ge],O(()=>{let h=a.length,f,c,b,w,A,S,$,v,_;if(h===0)o!==0&&(Q(r),r=[],l=[],s=[],o=0,i&&(i=[])),t.fallback&&(l=[Se],s[0]=L(he=>(r[0]=he,t.fallback())),o=1);else if(o===0){for(s=new Array(h),u=0;u<h;u++)l[u]=a[u],s[u]=L(m);o=h}else{for(b=new Array(h),w=new Array(h),i&&(A=new Array(h)),S=0,$=Math.min(o,h);S<$&&l[S]===a[S];S++);for($=o-1,v=h-1;$>=S&&v>=S&&l[$]===a[v];$--,v--)b[v]=s[$],w[v]=r[$],i&&(A[v]=i[$]);for(f=new Map,c=new Array(v+1),u=v;u>=S;u--)_=a[u],d=f.get(_),c[u]=d===void 0?-1:d,f.set(_,u);for(d=S;d<=$;d++)_=l[d],u=f.get(_),u!==void 0&&u!==-1?(b[u]=s[d],w[u]=r[d],i&&(A[u]=i[d]),u=c[u],f.set(_,u)):r[d]();for(u=S;u<h;u++)u in b?(s[u]=b[u],r[u]=w[u],i&&(i[u]=A[u],i[u](u))):s[u]=L(m);s=s.slice(0,o=h),l=a.slice(0)}return s});function m(h){if(r[u]=h,i){const[f,c]=E(u);return i[u]=c,n(a[u],f)}return n(a[u])}}}function P(e,n){return O(()=>e(n||{}))}const $e=e=>`Stale read from <${e}>.`;function Te(e){const n="fallback"in e&&{fallback:()=>e.fallback};return G(Ae(()=>e.each,e.children,n||void 0))}function W(e){const n=e.keyed,t=G(()=>e.when,void 0,{equals:(l,s)=>n?l===s:!l==!s});return G(()=>{const l=t();if(l){const s=e.children;return typeof s=="function"&&s.length>0?O(()=>s(n?l:()=>{if(!O(t))throw $e("Show");return e.when})):s}return e.fallback},void 0,void 0)}function ve(e,n,t){let l=t.length,s=n.length,r=l,o=0,i=0,a=n[s-1].nextSibling,d=null;for(;o<s||i<r;){if(n[o]===t[i]){o++,i++;continue}for(;n[s-1]===t[r-1];)s--,r--;if(s===o){const u=r<l?i?t[i-1].nextSibling:t[r-i]:a;for(;i<r;)e.insertBefore(t[i++],u)}else if(r===i)for(;o<s;)(!d||!d.has(n[o]))&&n[o].remove(),o++;else if(n[o]===t[r-1]&&t[i]===n[s-1]){const u=n[--s].nextSibling;e.insertBefore(t[i++],n[o++].nextSibling),e.insertBefore(t[--r],u),n[s]=t[r]}else{if(!d){d=new Map;let m=i;for(;m<r;)d.set(t[m],m++)}const u=d.get(n[o]);if(u!=null)if(i<u&&u<r){let m=o,h=1,f;for(;++m<s&&m<r&&!((f=d.get(n[m]))==null||f!==u+h);)h++;if(h>u-i){const c=n[o];for(;i<u;)e.insertBefore(t[i++],c)}else e.replaceChild(t[i++],n[o++])}else o++;else n[o++].remove()}}}const X="_$DX_DELEGATE";function Ee(e,n,t,l={}){let s;return L(r=>{s=r,n===document?e():I(n,e(),n.firstChild?null:void 0,t)},l.owner),()=>{s(),n.textContent=""}}function T(e,n,t){let l;const s=()=>{const o=document.createElement("template");return o.innerHTML=e,t?o.content.firstChild.firstChild:o.content.firstChild},r=n?()=>O(()=>document.importNode(l||(l=s()),!0)):()=>(l||(l=s())).cloneNode(!0);return r.cloneNode=r,r}function Oe(e,n=window.document){const t=n[X]||(n[X]=new Set);for(let l=0,s=e.length;l<s;l++){const r=e[l];t.has(r)||(t.add(r),n.addEventListener(r,xe))}}function J(e,n,t){t==null?e.removeAttribute(n):e.setAttribute(n,t)}function Y(e,n,t){return O(()=>e(n,t))}function I(e,n,t,l){if(t!==void 0&&!l&&(l=[]),typeof n!="function")return R(e,n,l,t);F(s=>R(e,n(),s,t),l)}function xe(e){const n=`$$${e.type}`;let t=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==t&&Object.defineProperty(e,"target",{configurable:!0,value:t}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}});t;){const l=t[n];if(l&&!t.disabled){const s=t[`${n}Data`];if(s!==void 0?l.call(t,s,e):l.call(t,e),e.cancelBubble)return}t=t._$host||t.parentNode||t.host}}function R(e,n,t,l,s){for(;typeof t=="function";)t=t();if(n===t)return t;const r=typeof n,o=l!==void 0;if(e=o&&t[0]&&t[0].parentNode||e,r==="string"||r==="number")if(r==="number"&&(n=n.toString()),o){let i=t[0];i&&i.nodeType===3?i.data=n:i=document.createTextNode(n),t=N(e,t,l,i)}else t!==""&&typeof t=="string"?t=e.firstChild.data=n:t=e.textContent=n;else if(n==null||r==="boolean")t=N(e,t,l);else{if(r==="function")return F(()=>{let i=n();for(;typeof i=="function";)i=i();t=R(e,i,t,l)}),()=>t;if(Array.isArray(n)){const i=[],a=t&&Array.isArray(t);if(V(i,n,t,s))return F(()=>t=R(e,i,t,l,!0)),()=>t;if(i.length===0){if(t=N(e,t,l),o)return t}else a?t.length===0?Z(e,i,l):ve(e,t,i):(t&&N(e),Z(e,i));t=i}else if(n.nodeType){if(Array.isArray(t)){if(o)return t=N(e,t,l,n);N(e,t,null,n)}else t==null||t===""||!e.firstChild?e.appendChild(n):e.replaceChild(n,e.firstChild);t=n}}return t}function V(e,n,t,l){let s=!1;for(let r=0,o=n.length;r<o;r++){let i=n[r],a=t&&t[r],d;if(!(i==null||i===!0||i===!1))if((d=typeof i)=="object"&&i.nodeType)e.push(i);else if(Array.isArray(i))s=V(e,i,a)||s;else if(d==="function")if(l){for(;typeof i=="function";)i=i();s=V(e,Array.isArray(i)?i:[i],Array.isArray(a)?a:[a])||s}else e.push(i),s=!0;else{const u=String(i);a&&a.nodeType===3&&a.data===u?e.push(a):e.push(document.createTextNode(u))}}return s}function Z(e,n,t=null){for(let l=0,s=n.length;l<s;l++)e.insertBefore(n[l],t)}function N(e,n,t,l){if(t===void 0)return e.textContent="";const s=l||document.createTextNode("");if(n.length){let r=!1;for(let o=n.length-1;o>=0;o--){const i=n[o];if(s!==i){const a=i.parentNode===e;!r&&!o?a?e.replaceChild(s,i):e.insertBefore(s,t):a&&i.remove()}else r=!0}}else e.insertBefore(s,t);return[s]}const fe=({signalState:e,melody:n,voice:t})=>{e?(n.loop=!0,n.play()):(n.pause(),n.currentTime=0,t.pause(),setTimeout(()=>{t.currentTime=0,t.play()},1e3))},ce=({prevState:e,signalState:n,melody:t,voice:l})=>{if(n)switch(e){case!0:return t.pause(),t.currentTime=0,setTimeout(()=>{l.currentTime=0,l.play()},1e3),!1;case!1:return t.loop=!0,t.play(),!0}else return e},ae=({signalState:e,melody:n,voice:t})=>{e?(n.currentTime=0,n.loop=!0,n.play()):(t.pause(),n.loop=!1,setTimeout(()=>{t.currentTime=0,t.play()},1e3))},de=({signalState:e,melody:n,voice:t})=>{e?(n.currentTime=0,n.loop=!0,n.play()):(t.pause(),n.loop=!1,n.addEventListener("ended",()=>{setTimeout(()=>{t.currentTime=0,t.play()},1e3)},{once:!0}))},z={OnOffButton:fe,ToggleButton:ce,TachikawaButton:ae,NishiOgikuboButton:de},K={OnOffButton:{name:"ON/OFF",handler:fe,default:!0},ToggleButton:{name:"Toggle ON/OFF",handler:ce,default:!1},TachikawaButton:{name:"Keep Melody",handler:ae,default:!1},NishiOgikuboButton:{name:"After Melody",handler:de,default:!1}},Ce=T("<h1>- .. -"),_e=T("<button>Connect"),Ne=T("<div class=handler-selector>"),Be=T('<span class="back-red text-white">ON'),Le=T("<div class=state-container>"),Pe=T("<audio src=/audio/MM.MM2.mp3 controls loop>"),Ie=T("<audio src=/audio/voice_door_close_metro.wav controls>"),Me=T("<span><input type=radio name=button-handler><label>"),ke=T("<span>disconnected..."),Fe=T('<span class="back-black text-white">OFF');function qe(){const[e,n]=E(null),[t,l]=E(null),[s,r]=E(!1),[o,i]=E(null),[a,d]=E(z.OnOffButton);let u=E(null),m=E(null);function h(){l(setInterval(async()=>{var A;const c=(await((A=e())==null?void 0:A.getSignals())).dataSetReady,b=u[0](),w=m[0]();if(b&&w&&o()!==null&&o()!==c){const S=a()({prevState:s(),signalState:c,melody:b,voice:w});r(S===void 0?c:S)}i(c)},10))}return te(()=>{const f=t();f&&clearInterval(f)}),[Ce(),(()=>{const f=_e();return f.$$click=async()=>{var c;try{const b=await navigator.serial.requestPort();n(b),window.port=b,console.log("Available [SerialPort] at [window.port]!",window.port);try{await((c=e())==null?void 0:c.open({baudRate:1})),h()}catch(w){(w==null?void 0:w.name)==="InvalidStateError"?h():console.error("SerialPort.open()",w)}}catch(b){console.error("Serial.requestPort()",b)}},f})(),(()=>{const f=Ne();return f.$$input=c=>{d(()=>z[c.target.value])},I(f,P(Te,{get each(){return Object.keys(K)},children:c=>(()=>{const b=Me(),w=b.firstChild,A=w.nextSibling;return J(w,"id","btn-handler-"+c),w.value=c,J(A,"for","btn-handler-"+c),I(A,()=>K[c].name),F(()=>w.checked=K[c].default),b})()})),f})(),(()=>{const f=Le();return I(f,P(W,{get when(){return e()},get fallback(){return ke()},get children(){return P(W,{get when(){return s()},get fallback(){return Fe()},get children(){return Be()}})}})),f})(),(()=>{const f=Pe(),c=u[1];return typeof c=="function"?Y(c,f):u[1]=f,f})(),(()=>{const f=Ie(),c=m[1];return typeof c=="function"?Y(c,f):m[1]=f,f})()]}Oe(["click","input"]);Ee(()=>P(qe,{}),document.querySelector("#root"));
